<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/* global PJS, _, _mtvnPlayerReady*/
/* exported Core */
var Core = (function(core) {
	var baseURL = &quot;http://media.mtvnservices.com/&quot;,
		// this is needed for the jQuery plugin only.
		getLegacyEventName = function(eventName) {
			if (eventName === &quot;uiStateChange&quot;) {
				return &quot;onUIStateChange&quot;;
			}
			return &quot;on&quot; + eventName.charAt(0).toUpperCase() + eventName.substr(1);
		};
	// exports
<span id='global-property-instances'>	/**
</span>	 * @property instances
	 * @ignore
	 * An array of all the player instances.
	 */
	core.instances = [];
<span id='global-property-baseURL'>	/**
</span>	 * @property baseURL
	 * @ignore
	 * The base URL for the player request and for swf object.
	 */
	core.baseURL = baseURL;
<span id='global-method-appendStyle'>	/**
</span>	 * Utility function. Append css to the head.
	 * @ignore
	 */
	core.appendStyle = function(cssText) {
		var styles = document.createElement(&quot;style&quot;);
		styles.setAttribute(&quot;type&quot;, &quot;text/css&quot;);
		document.getElementsByTagName(&quot;head&quot;)[0].appendChild(styles);
		if (styles.styleSheet) {
			styles.styleSheet.cssText = cssText;
		} else {
			styles.appendChild(document.createTextNode(cssText));
		}
	};

<span id='global-method-getPath'>	/**
</span>	 * @method getPath
	 * @ignore
	 * @param {Object} config
	 * Check if there&#39;s a template URL (usually used for testing),
	 * otherwise join the baseURL with the config.uri
	 */
	core.getPath = function(config) {
		if (config.templateURL) {
			return config.templateURL.replace(&quot;{uri}&quot;, config.uri);
		}
		return baseURL + config.uri;
	};
<span id='global-method-processPerformance'>	/**
</span>	 * @method processPerformance
	 * @ignore
	 * @param {PJS.Player} player
	 * @param {Object} performance data
	 */
	core.processPerformance = function(player, data) {
		var startTime = player.config.performance.startTime,
			eventType = PJS.Events.PERFORMANCE;
		for (var prop in data) {
			if (data.hasOwnProperty(prop)) {
				// adjust to the start time recorded by the embed api.
				data[prop] = data[prop] - startTime;
			}
		}
		core.processEvent(player.events[eventType], {
			data: data,
			target: player,
			type: eventType
		});
	};
<span id='global-method-processEvent'>	/**
</span>	 * @method processEvent
	 * @ignore
	 * @param {Object} {Array} event
	 * @param {Object} data
	 * Check if event is an Array, if so loop through, else just execute.
	 */
	core.processEvent = function(event, data) {
		// trigger a jQuery event if there&#39;s an $el.
		if (data &amp;&amp; data.target &amp;&amp; data.target.$el) {
			data.target.$el.trigger(&quot;MTVNPlayer:&quot; + data.type, data);
			// legacy event names
			data.target.$el.trigger(&quot;MTVNPlayer:&quot; + getLegacyEventName(data.type), data);
		}
		if (!event) {
			return;
		}
		if (_.isArray(event)) {
			// clone array
			event = event.slice();
			// fire in order
			for (var i = 0, len = event.length; i &lt; len; i++) {
				event[i](data);
			}
		} else {
			event(data);
		}
	};
<span id='global-method-getPlayerInstance'>	/**
</span>	 * @method getPlayerInstance
	 * @ignore
	 * @param {ContentWindow} source
	 * @returns {PJS.Player} A player instance
	 */
	core.getPlayerInstance = function(source) {
		var i, player = null,
			numberOfInstances = core.instances.length,
			currentInstance;
		for (i = numberOfInstances; i--;) {
			currentInstance = core.instances[i];
			if (currentInstance.source === source) {
				// compare source (contentWindow) to get events object from the right player. (if flash, source is the embed id)
				player = currentInstance.player;
				break;
			}
		}
		return player;
	};
<span id='global-method-executeCallbacks'>	/**
</span>	 * @method executeCallbacks
	 * @ignore
	 * @param {PJS.Player} player
	 * Fires callbacks registered with PJS.onPlayer
	 */
	core.executeCallbacks = function(player) {
		_.each(_mtvnPlayerReady, function(callback) {
			if (_.isFunction(callback)) {
				callback(player);
			}
		});
	};
	return core;
})({});
</pre>
</body>
</html>
